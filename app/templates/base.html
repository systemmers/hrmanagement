<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>{% block title %}인사카드 관리 시스템{% endblock %}</title>

    <!-- Resource Hints -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//i.pravatar.cc">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Google Fonts Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome 6.4.0 with SRI -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer">

    <!-- CSS Variables -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/variables.css') }}">

    <!-- 메인 스타일시트 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- Forms 스타일시트 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/forms.css') }}">

    {% block extra_css %}{% endblock %}
</head>
<body>
    {% if current_user.is_authenticated %}
    <!-- 상단 헤더 -->
    <header class="app-header">
        <div class="header-brand">
            <div class="header-logo">HR</div>
            <h1 class="header-title">인사카드 관리 시스템</h1>
        </div>

        <div class="header-search" role="search">
            <i class="fas fa-search header-search-icon"></i>
            <input type="text"
                   id="headerSearchInput"
                   data-search="employee"
                   class="header-search-input"
                   placeholder="직원 검색 (이름, 부서, 직급)"
                   aria-label="직원 검색"
                   aria-describedby="header-search-help">
            <span id="header-search-help" class="sr-only">직원의 이름, 부서 또는 직급을 입력하여 검색하세요</span>
        </div>

        <div class="header-actions">
            <div class="header-user">
                <div class="header-user-avatar">{{ current_user.name | first_char }}</div>
                <span class="header-user-name">{{ current_user.name }}</span>
            </div>
            <a href="{{ url_for('auth.logout') }}" class="btn-logout">
                <i class="fas fa-sign-out-alt"></i>
                <span>로그아웃</span>
            </a>
        </div>
    </header>

    <!-- 메인 컨테이너 -->
    <div class="app-container">
        <div class="app-layout">
            <!-- 좌측 사이드바 -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h1 class="sidebar-title">인사카드 관리</h1>
                    <p class="sidebar-subtitle">직원 정보 통합 관리 시스템</p>
                </div>

                <nav class="sidebar-nav">
                    <!-- 조회 섹션 -->
                    <div class="nav-section">
                        <h2 class="nav-section-title">조회</h2>
                        <a href="{{ url_for('employee.index') }}"
                           class="nav-item {% if request.endpoint == 'employee.index' %}active{% endif %}">
                            <i class="fas fa-home"></i>
                            <span>대시보드</span>
                        </a>
                        <div class="nav-item">
                            <i class="fas fa-search"></i>
                            <div style="flex: 1;">
                                <input type="text"
                                       id="searchInput"
                                       data-search="employee"
                                       class="search-input"
                                       placeholder="이름으로 검색...">
                            </div>
                        </div>
                    </div>

                    <!-- 입력 섹션 -->
                    <div class="nav-section">
                        <h2 class="nav-section-title">입력</h2>
                        <a href="{{ url_for('employee.new') }}"
                           class="nav-item {% if request.endpoint == 'employee.new' %}active{% endif %}">
                            <i class="fas fa-user-plus"></i>
                            <span>직원 등록</span>
                        </a>
                    </div>
                </nav>

                <div class="sidebar-footer">
                    <div class="user-info">
                        <div class="user-avatar">{{ current_user.name | first_char }}</div>
                        <div class="user-details">
                            <div class="user-name">{{ current_user.name }}</div>
                            <div class="user-role">시스템 관리자</div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- 메인 컨텐츠 -->
            <main class="main-content">
                {% block content %}{% endblock %}
            </main>

            <!-- 우측 사이드바 (선택적) -->
            {% block right_sidebar %}{% endblock %}
        </div>
    </div>
    {% else %}
    <!-- 로그인하지 않은 경우 -->
    {% block auth_content %}{% endblock %}
    {% endif %}

    <!-- 토스트 알림 컨테이너 -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Flash 메시지 처리 -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div data-flash-message="{{ message }}" data-flash-category="{{ category }}" role="alert" aria-live="polite" style="display: none;"></div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- 메인 JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>

    {% block extra_js %}{% endblock %}
</body>
</html>
