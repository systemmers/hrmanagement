{#
    개인 계정 - 회사 인사카드 페이지

    개인 계정이 계약한 법인의 인사카드를 조회하는 페이지입니다.
    공유 파셜 템플릿을 include하여 법인 직원 인사카드(mypage/company_info.html)와
    동일한 구조를 유지합니다.

    컨텍스트 변수:
    - employee: 직원 정보 (프로필 기반으로 구성된 dict)
    - company: 회사 정보
    - contract: 계약 정보
    - page_mode: 'hr_card' (법인 전용 섹션 표시)
    - education_list, career_list 등: 이력 데이터
    - salary_history_list, promotion_list 등: 인사기록 데이터
#}
{% extends "shared/base.html" %}

{% block title %}{{ company.name }} 인사카드 - 인사카드 관리 시스템{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/shared/layouts/section-nav.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/shared/layouts/right-sidebar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/shared/components/attachment.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/domains/attachment/index.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/domains/employee/header.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/domains/employee/business-card.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/shared/components/card.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/shared/components/table.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/domains/employee/detail.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/domains/user/company-card-detail.css') }}">
{% endblock %}

{% block content %}
{# 내부 섹션 네비게이션 제거 - 사이드바로 통합 (2026-01-12) #}

<div class="detail-page-layout detail-page-layout--no-sidebar-nav" data-account-type="{{ account_type|default('personal') }}">
    {# 메인 콘텐츠 #}
    <div class="detail-main-content">
        {# 종료된 계약 안내 배너 #}
        {% if show_termination_notice %}
        <div class="termination-notice-banner">
            <div class="notice-icon">
                <i class="fas fa-archive"></i>
            </div>
            <div class="notice-content">
                <h4>종료된 계약의 인사카드입니다</h4>
                <p>
                    {{ terminated_at[:10] if terminated_at else '알 수 없음' }} 종료
                    {% if termination_reason %}
                    | 사유: {{ termination_reason }}
                    {% endif %}
                </p>
                <p class="notice-info">
                    <i class="fas fa-info-circle"></i>
                    이 정보는 법적 보관 의무에 따라 3년간 보관됩니다. 읽기 전용으로만 열람 가능합니다.
                </p>
            </div>
        </div>
        {% endif %}

        {# 페이지 헤더 #}
        <div class="detail-page-header">
            <h1 class="detail-page-title">
                {{ company.name }} 인사카드
                {% if is_terminated %}
                <span class="status-badge terminated">
                    <i class="fas fa-archive"></i>
                    종료됨
                </span>
                {% endif %}
            </h1>
            <div class="detail-page-actions">
                <a href="{{ url_for('personal.company_card_list') }}" class="btn btn--secondary">
                    <i class="fas fa-arrow-left"></i>
                    <span>목록으로</span>
                </a>
            </div>
        </div>

        {# 직원 헤더 카드 - 공유 파셜 #}
        {% if employee %}
        {% include 'domains/employee/partials/detail/_employee_header.html' %}
        {% endif %}

        {# 섹션 1-7: 기본정보 - 공유 파셜 (개인정보, 소속정보, 계약정보, 급여정보, 복리후생, 4대보험, 가족정보) #}
        {% include 'domains/employee/partials/detail/_basic_info.html' %}

        {# 섹션 8-14: 이력 및 경력 - 공유 파셜 (학력, 경력, 자격증, 언어능력, 병역, 수상, 프로젝트) #}
        {% include 'domains/employee/partials/detail/_history_info.html' %}

        {# 섹션 15-17: 인사기록 - 공유 파셜 (근로계약/연봉, 인사이동/고과, 근태/비품) #}
        {% include 'domains/employee/partials/detail/_hr_records.html' %}
    </div>
</div>

{# 모바일 섹션 네비게이션 토글 버튼 #}
<button class="mobile-section-nav-toggle" id="mobileNavToggle">
    <i class="fas fa-bars"></i>
</button>

{# 모바일 오버레이 #}
<div class="section-nav-overlay" id="sectionNavOverlay"></div>
{% endblock %}

{% block sidebar_right %}
{# 첨부파일 사이드바 (조회 전용) #}
{% include 'shared/partials/_attachment_sidebar.html' %}
{% endblock %}

{% block extra_js %}
<script type="module" src="{{ url_for('static', filename='js/domains/employee/pages/detail.js') }}"></script>
<script src="{{ url_for('static', filename='js/domains/employee/components/business-card.js') }}"></script>
{% endblock %}
