{% extends "base.html" %}
{% block title %}AI 설정{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/ai-test.css') }}">
{% endblock %}

{% block content %}
<div class="ai-settings-container">
    <div class="page-header">
        <h1>
            <i class="fas fa-sliders-h"></i> AI 설정
        </h1>
        <p class="subtitle">AI Provider 설정 상태 및 구성 정보를 확인합니다.</p>
    </div>

    <!-- 사용 가능한 Provider -->
    <div class="card">
        <h3><i class="fas fa-robot"></i> 사용 가능한 Provider</h3>

        {% if providers %}
        <div class="provider-list">
            {% for provider in providers %}
            <div class="provider-badge active">
                {% if provider == 'gemini' %}
                <i class="fas fa-gem"></i>
                {% elif provider == 'vertex_ai' %}
                <i class="fas fa-cloud"></i>
                {% elif provider == 'document_ai' %}
                <i class="fas fa-file-alt"></i>
                {% else %}
                <i class="fas fa-robot"></i>
                {% endif %}
                {{ provider | title | replace('_', ' ') }}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-providers">
            <i class="fas fa-exclamation-circle"></i>
            <p>사용 가능한 Provider가 없습니다.</p>
            <p class="text-xs mt-2">
                환경 변수를 설정하거나 AI Service를 구현해주세요.
            </p>
        </div>
        {% endif %}
    </div>

    <!-- Gemini API 설정 -->
    <div class="card">
        <h3><i class="fas fa-gem"></i> Gemini API (AI Studio)</h3>

        <table class="config-table">
            <tr>
                <td class="label">API Key</td>
                <td class="value">
                    {% if config.gemini_api_key %}
                    <span class="status-badge status-configured">
                        <i class="fas fa-check"></i> 설정됨
                    </span>
                    <span class="ml-3">{{ config.gemini_api_key_preview }}</span>
                    {% else %}
                    <span class="status-badge status-not-configured">
                        <i class="fas fa-times"></i> 미설정
                    </span>
                    {% endif %}
                </td>
            </tr>
        </table>

        <div class="info-box">
            <h4><i class="fas fa-info-circle"></i> Gemini API 설정 방법</h4>
            <p>
                Google AI Studio에서 API 키를 발급받아 <code>.env</code> 파일에 설정합니다.
            </p>
            <div class="code-block">
                <span class="comment"># .env 파일</span><br>
                <span class="key">GEMINI_API_KEY</span>=<span class="value">"your-api-key-here"</span>
            </div>
        </div>
    </div>

    <!-- Google Cloud 설정 -->
    <div class="card">
        <h3><i class="fas fa-cloud"></i> Google Cloud Platform</h3>

        <table class="config-table">
            <tr>
                <td class="label">Project ID</td>
                <td class="value">{{ config.google_project_id }}</td>
            </tr>
            <tr>
                <td class="label">Location</td>
                <td class="value">{{ config.google_location }}</td>
            </tr>
            <tr>
                <td class="label">Service Account</td>
                <td class="value">
                    {% if config.google_credentials %}
                    <span class="status-badge status-configured">
                        <i class="fas fa-check"></i> 설정됨
                    </span>
                    {% else %}
                    <span class="status-badge status-not-configured">
                        <i class="fas fa-times"></i> 미설정
                    </span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td class="label">Document AI Processor</td>
                <td class="value">
                    {% if config.documentai_processor %}
                    <span class="status-badge status-configured">
                        <i class="fas fa-check"></i> 설정됨
                    </span>
                    {% else %}
                    <span class="status-badge status-not-configured">
                        <i class="fas fa-times"></i> 미설정
                    </span>
                    {% endif %}
                </td>
            </tr>
        </table>

        <div class="info-box">
            <h4><i class="fas fa-info-circle"></i> Google Cloud 설정 방법</h4>
            <p>
                서비스 계정 JSON 파일 경로와 프로젝트 정보를 <code>.env</code> 파일에 설정합니다.
            </p>
            <div class="code-block">
                <span class="comment"># .env 파일</span><br>
                <span class="key">GOOGLE_APPLICATION_CREDENTIALS</span>=<span class="value">"path/to/service-account.json"</span><br>
                <span class="key">GOOGLE_PROJECT_ID</span>=<span class="value">"your-project-id"</span><br>
                <span class="key">GOOGLE_LOCATION</span>=<span class="value">"asia-northeast3"</span><br>
                <span class="key">DOCUMENTAI_PROCESSOR_ID</span>=<span class="value">"your-processor-id"</span>
            </div>
        </div>

        <div class="warning-box">
            <h4><i class="fas fa-exclamation-triangle"></i> 보안 주의사항</h4>
            <p>
                서비스 계정 JSON 파일은 절대로 Git에 커밋하지 마세요.
                <code>.gitignore</code>에 해당 파일이 포함되어 있는지 확인하세요.
            </p>
        </div>
    </div>

    <!-- 테스트 파일 정보 -->
    <div class="card">
        <h3><i class="fas fa-folder-open"></i> 샘플 파일 위치</h3>

        <table class="config-table">
            <tr>
                <td class="label">샘플 디렉토리</td>
                <td class="value">data/db_files/</td>
            </tr>
            <tr>
                <td class="label">지원 파일 형식</td>
                <td class="value">PDF, JPG, JPEG, PNG, GIF</td>
            </tr>
        </table>

        <div class="info-box">
            <h4><i class="fas fa-lightbulb"></i> 테스트 방법</h4>
            <p>
                <code>data/db_files/</code> 디렉토리에 테스트할 문서를 추가하면
                문서 분석 테스트 페이지에서 샘플 파일로 선택할 수 있습니다.
            </p>
        </div>
    </div>
</div>
{% endblock %}
