{#
    통합 사이드바 템플릿
    - account_type과 role 기반 동적 메뉴 생성
    - 개인(personal), 법인 직원(employee), 법인 관리자(corporate) 통합
    Phase 3: 템플릿 통합 작업
#}

{# ========================================
   개인 계정 (Personal) 메뉴
   ======================================== #}
{% if current_user and current_user.account_type == 'personal' %}

<!-- 내 정보 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">내 정보</h2>
    <a href="{{ url_for('personal.dashboard') }}"
       class="nav-item {% if request.endpoint == 'personal.dashboard' %}active{% endif %}">
        <i class="fas fa-tachometer-alt"></i>
        <span>대시보드</span>
    </a>
    <a href="{{ url_for('personal.profile') }}"
       class="nav-item {% if request.endpoint == 'personal.profile' or request.endpoint == 'personal.profile_edit' %}active{% endif %}">
        <i class="fas fa-user"></i>
        <span>프로필</span>
    </a>
</div>

<!-- 계약 관리 섹션 (개인) -->
<div class="nav-section">
    <h2 class="nav-section-title">계약 관리</h2>
    <a href="{{ url_for('contracts.my_contracts') }}"
       class="nav-item {% if request.endpoint == 'contracts.my_contracts' %}active{% endif %}">
        <i class="fas fa-file-contract"></i>
        <span>내 계약</span>
    </a>
    <a href="{{ url_for('contracts.pending_contracts') }}"
       class="nav-item {% if request.endpoint == 'contracts.pending_contracts' %}active{% endif %}">
        <i class="fas fa-clock"></i>
        <span>대기 중인 요청</span>
    </a>
</div>

{# ========================================
   법인 직원 (Employee Sub) 메뉴
   ======================================== #}
{% elif current_user and current_user.role == 'employee' and current_user.employee_id %}

<!-- 내 정보 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">내 정보</h2>
    <a href="{{ url_for('employees.employee_detail', employee_id=current_user.employee_id, view='basic') }}"
       class="nav-item {% if request.endpoint == 'employees.employee_detail' and request.args.get('view') == 'basic' %}active{% endif %}">
        <i class="fas fa-id-card"></i>
        <span>기본정보</span>
    </a>
    <a href="{{ url_for('employees.employee_detail', employee_id=current_user.employee_id, view='history') }}"
       class="nav-item {% if request.endpoint == 'employees.employee_detail' and request.args.get('view') == 'history' %}active{% endif %}">
        <i class="fas fa-history"></i>
        <span>이력정보</span>
    </a>
</div>

<!-- 회사정보 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">회사정보</h2>
    <a href="{{ url_for('mypage.company_info') }}"
       class="nav-item {% if request.endpoint == 'mypage.company_info' %}active{% endif %}">
        <i class="fas fa-building"></i>
        <span>회사 인사카드</span>
    </a>
</div>

<!-- 계정관리 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">계정관리</h2>
    <a href="{{ url_for('auth.change_password') }}"
       class="nav-item {% if request.endpoint == 'auth.change_password' %}active{% endif %}">
        <i class="fas fa-key"></i>
        <span>계정정보</span>
    </a>
</div>

{# ========================================
   법인 관리자/매니저 (Corporate Admin) 메뉴
   ======================================== #}
{% else %}

<!-- 대시보드 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">대시보드</h2>
    <a href="{{ url_for('main.index') }}" class="nav-item {% if request.endpoint == 'main.index' %}active{% endif %}">
        <i class="fas fa-tachometer-alt"></i>
        <span>직원 현황</span>
    </a>
</div>

<!-- 직원 관리 섹션 -->
<div class="nav-section">
    <h2 class="nav-section-title">직원 관리</h2>
    <a href="{{ url_for('employees.employee_list') }}" class="nav-item {% if request.endpoint == 'employees.employee_list' %}active{% endif %}">
        <i class="fas fa-users"></i>
        <span>직원 목록</span>
    </a>
    <a href="{{ url_for('employees.employee_new') }}" class="nav-item {% if request.endpoint == 'employees.employee_new' %}active{% endif %}">
        <i class="fas fa-user-plus"></i>
        <span>직원 등록</span>
    </a>
</div>

<!-- 계약 관리 섹션 (법인) -->
{% if current_user and current_user.account_type == 'corporate' %}
<div class="nav-section">
    <h2 class="nav-section-title">계약 관리</h2>
    <a href="{{ url_for('contracts.company_contracts') }}"
       class="nav-item {% if request.endpoint == 'contracts.company_contracts' %}active{% endif %}">
        <i class="fas fa-file-contract"></i>
        <span>계약 목록</span>
    </a>
    <a href="{{ url_for('contracts.request_contract') }}"
       class="nav-item {% if request.endpoint == 'contracts.request_contract' %}active{% endif %}">
        <i class="fas fa-paper-plane"></i>
        <span>계약 요청</span>
    </a>
    <a href="{{ url_for('contracts.company_pending') }}"
       class="nav-item {% if request.endpoint == 'contracts.company_pending' %}active{% endif %}">
        <i class="fas fa-clock"></i>
        <span>대기 중</span>
    </a>
</div>
{% endif %}

<!-- 법인 관리 섹션 (관리자 전용) -->
{% if current_user and current_user.is_admin %}
<div class="nav-section">
    <h2 class="nav-section-title">법인 관리</h2>
    <a href="{{ url_for('corporate.dashboard') }}" class="nav-item {% if request.endpoint == 'corporate.dashboard' %}active{% endif %}">
        <i class="fas fa-building"></i>
        <span>법인 대시보드</span>
    </a>
    <a href="{{ url_for('profile.view') }}" class="nav-item {% if request.endpoint and request.endpoint.startswith('profile.') %}active{% endif %}">
        <i class="fas fa-user-tie"></i>
        <span>관리자 프로필</span>
    </a>
    <a href="{{ url_for('corporate.settings') }}" class="nav-item {% if request.endpoint == 'corporate.settings' %}active{% endif %}">
        <i class="fas fa-building"></i>
        <span>법인 설정</span>
    </a>
    <a href="{{ url_for('corporate.users') }}" class="nav-item {% if request.endpoint == 'corporate.users' %}active{% endif %}">
        <i class="fas fa-users-cog"></i>
        <span>사용자 관리</span>
    </a>
    <a href="{{ url_for('corporate.add_user') }}" class="nav-item {% if request.endpoint == 'corporate.add_user' %}active{% endif %}">
        <i class="fas fa-user-plus"></i>
        <span>사용자 추가</span>
    </a>
    <a href="{{ url_for('admin.organization_list') }}" class="nav-item {% if request.endpoint == 'admin.organization_list' %}active{% endif %}">
        <i class="fas fa-sitemap"></i>
        <span>조직 관리</span>
    </a>
    <a href="{{ url_for('classification.classification_options_page') }}" class="nav-item {% if request.endpoint == 'classification.classification_options_page' %}active{% endif %}">
        <i class="fas fa-cog"></i>
        <span>분류 옵션 관리</span>
    </a>
</div>
{% endif %}

<!-- AI 테스트 섹션 (프로토타입) -->
<div class="nav-section">
    <h2 class="nav-section-title">
        <i class="fas fa-flask"></i> AI 테스트
    </h2>
    <a href="{{ url_for('ai_test.index') }}" class="nav-item {% if request.endpoint and request.endpoint.startswith('ai_test.') and request.endpoint != 'ai_test.compare' and request.endpoint != 'ai_test.settings' %}active{% endif %}">
        <i class="fas fa-robot"></i>
        <span>문서 분석 테스트</span>
    </a>
    <a href="{{ url_for('ai_test.compare') }}" class="nav-item {% if request.endpoint == 'ai_test.compare' %}active{% endif %}">
        <i class="fas fa-balance-scale"></i>
        <span>Provider 비교</span>
    </a>
    <a href="{{ url_for('ai_test.settings') }}" class="nav-item {% if request.endpoint == 'ai_test.settings' %}active{% endif %}">
        <i class="fas fa-sliders-h"></i>
        <span>AI 설정</span>
    </a>
    <a href="{{ url_for('mypage.company_info') }}" class="nav-item {% if request.endpoint == 'mypage.company_info' %}active{% endif %}">
        <i class="fas fa-id-card"></i>
        <span>회사 인사카드</span>
    </a>
    <a href="{{ url_for('main.data_table_demo') }}" class="nav-item {% if request.endpoint == 'main.data_table_demo' %}active{% endif %}">
        <i class="fas fa-table"></i>
        <span>데이터 테이블 데모</span>
    </a>
    <a href="{{ url_for('main.styleguide') }}" class="nav-item {% if request.endpoint == 'main.styleguide' %}active{% endif %}">
        <i class="fas fa-palette"></i>
        <span>스타일 가이드</span>
    </a>
</div>

{% endif %}
