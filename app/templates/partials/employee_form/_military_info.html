{#
    직원 폼 - 병역정보 섹션
    employee: 직원 객체 (수정 모드일 때)
#}
{% from 'macros/_cards.html' import form_section_card %}

{# military 변수 설정: employee.military_service 또는 별도 military 변수 사용 #}
{% set mil = employee.military_service if employee and employee.military_service else (military if military else {}) %}

{% call form_section_card('병역정보', 'fas fa-shield-alt', 'military-info') %}
<div class="form-grid">
    <div class="form-group">
        <label for="military_status" class="form-label">병역사항</label>
        <select id="military_status" name="military_status" class="form-input">
            <option value="">선택하세요</option>
            {% for opt in MILITARY_STATUS_OPTIONS %}
            <option value="{{ opt.value }}" {% if mil.service_type == opt.value or mil.status == opt.value or (employee and employee.military_status == opt.value) %}selected{% endif %}>{{ opt.label }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label for="military_branch" class="form-label">군별</label>
        <select id="military_branch" name="military_branch" class="form-input">
            <option value="">선택하세요</option>
            {% for opt in MILITARY_BRANCH_OPTIONS %}
            <option value="{{ opt.value }}" {% if mil.branch == opt.value or (employee and employee.military_branch == opt.value) %}selected{% endif %}>{{ opt.label }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label for="military_rank" class="form-label">계급</label>
        <input type="text" id="military_rank" name="military_rank" class="form-input"
               value="{{ mil.rank if mil.rank else (employee.military_rank if employee and employee.military_rank else '') }}"
               placeholder="병장, 상병 등">
    </div>

    <div class="form-group">
        <label for="military_period" class="form-label">복무기간</label>
        <input type="text" id="military_period" name="military_period" class="form-input"
               value="{{ (mil.start_date ~ ' ~ ' ~ mil.end_date) if mil.start_date and mil.end_date else (employee.military_period if employee and employee.military_period else '') }}"
               placeholder="2018.01 ~ 2019.10">
    </div>

    <div class="form-group">
        <label for="military_duty" class="form-label">보직</label>
        <input type="text" id="military_duty" name="military_duty" class="form-input"
               value="{{ mil.duty if mil.duty else (employee.military_duty if employee and employee.military_duty else '') }}"
               placeholder="운전병, 행정병 등">
    </div>

    <div class="form-group">
        <label for="military_specialty" class="form-label">병과</label>
        <input type="text" id="military_specialty" name="military_specialty" class="form-input"
               value="{{ mil.specialty if mil.specialty else (employee.military_specialty if employee and employee.military_specialty else '') }}"
               placeholder="보병, 통신, 의무 등">
    </div>

    <div class="form-group form-group-full">
        <label for="military_exemption_reason" class="form-label">면제사유</label>
        <input type="text" id="military_exemption_reason" name="military_exemption_reason" class="form-input"
               value="{{ mil.exemption_reason if mil.exemption_reason else (employee.military_exemption_reason if employee and employee.military_exemption_reason else '') }}"
               placeholder="병역면제 사유 (해당 시 입력)">
    </div>
</div>
{% endcall %}
