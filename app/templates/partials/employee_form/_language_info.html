{#
    직원 폼 - 언어능력 섹션 (동적 폼)
    Phase 9: FieldRegistry 필드명 동기화
    employee: 직원 객체 (수정 모드일 때)
    language_list: 언어 능력 목록
#}
{% from 'macros/_cards.html' import form_section_card_dynamic %}
{% from 'macros/_form_controls.html' import remove_button %}

{% call form_section_card_dynamic('언어능력', 'fas fa-language', 'language-info', 'addLanguage', '추가') %}
<div class="dynamic-list" id="languageList">
    {% if language_list and language_list|length > 0 %}
        {% for lang in language_list %}
        <div class="dynamic-item" data-index="{{ loop.index0 }}">
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">언어</label>
                    <select name="language_language[]" class="form-input">
                        <option value="">선택하세요</option>
                        {% for opt in LANGUAGE_OPTIONS %}
                        <option value="{{ opt.value }}" {% if lang.language == opt.value %}selected{% endif %}>{{ opt.label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">수준</label>
                    <select name="language_level[]" class="form-input">
                        <option value="">선택하세요</option>
                        {% for opt in LANGUAGE_LEVEL_OPTIONS %}
                        <option value="{{ opt.value }}" {% if lang.level == opt.value or lang.proficiency == opt.value %}selected{% endif %}>{{ opt.label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">시험명</label>
                    <input type="text" name="language_test_name[]" class="form-input"
                           value="{{ lang.test_name }}"
                           placeholder="TOEIC, JLPT 등">
                </div>
                <div class="form-group">
                    <label class="form-label">점수/급수</label>
                    <input type="text" name="language_score[]" class="form-input"
                           value="{{ lang.score }}"
                           placeholder="900점, N1 등">
                </div>
                <div class="form-group">
                    <label class="form-label">취득일</label>
                    <input type="date" name="language_test_date[]" class="form-input"
                           value="{{ lang.test_date }}">
                </div>
            </div>
            {{ remove_button() }}
        </div>
        {% endfor %}
    {% else %}
    <div class="dynamic-item" data-index="0">
        <div class="form-grid">
            <div class="form-group">
                <label class="form-label">언어</label>
                <select name="language_language[]" class="form-input">
                    <option value="">선택하세요</option>
                    {% for opt in LANGUAGE_OPTIONS %}
                    <option value="{{ opt.value }}">{{ opt.label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">수준</label>
                <select name="language_level[]" class="form-input">
                    <option value="">선택하세요</option>
                    {% for opt in LANGUAGE_LEVEL_OPTIONS %}
                    <option value="{{ opt.value }}">{{ opt.label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">시험명</label>
                <input type="text" name="language_test_name[]" class="form-input"
                       placeholder="TOEIC, JLPT 등">
            </div>
            <div class="form-group">
                <label class="form-label">점수/급수</label>
                <input type="text" name="language_score[]" class="form-input"
                       placeholder="900점, N1 등">
            </div>
            <div class="form-group">
                <label class="form-label">취득일</label>
                <input type="date" name="language_test_date[]" class="form-input">
            </div>
        </div>
        {{ remove_button() }}
    </div>
    {% endif %}
</div>
{% endcall %}
