{#
    직원 폼 - 개인 기본정보 섹션
    employee: 직원 객체 (수정 모드일 때)
    action: 'create' 또는 'update'
#}
<section class="form-section" id="personal-info">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-user"></i>
                개인 기본정보
            </h2>
        </div>
        <div class="card-body">
            {# 프로필 사진 영역 #}
            <div class="photo-upload-section">
                <div class="photo-preview" id="photoPreview">
                    {% if employee and employee.photo %}
                    <img src="{{ employee.photo }}" alt="프로필 사진" id="previewImage">
                    {% else %}
                    <div class="photo-placeholder" id="photoPlaceholder">
                        <i class="fas fa-user"></i>
                        <span>사진 미등록</span>
                    </div>
                    {% endif %}
                </div>
                <div class="photo-upload-controls">
                    {% if action == 'update' and employee %}
                    {# 수정 모드: 파일 업로드 #}
                    <label class="form-label">프로필 사진</label>
                    <div class="photo-file-upload" id="photoFileUpload">
                        <input type="file" id="photoFile" name="photoFile"
                               accept="image/jpeg,image/png,image/gif,image/webp"
                               class="form-input-file" style="display: none;">
                        <input type="hidden" id="photo" name="photo" value="{{ employee.photo if employee else '' }}">
                        <div class="photo-upload-buttons">
                            <button type="button" class="btn btn-secondary btn-sm" id="selectPhotoBtn">
                                <i class="fas fa-camera"></i> 사진 선택
                            </button>
                            {% if employee and employee.photo and not employee.photo.startswith('http') %}
                            <button type="button" class="btn btn-outline-danger btn-sm" id="deletePhotoBtn">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                            {% endif %}
                        </div>
                        <small class="form-help">JPG, PNG, GIF, WebP (최대 5MB)</small>
                    </div>
                    {% else %}
                    {# 신규 등록 모드: 비활성화 안내 #}
                    <label class="form-label">프로필 사진</label>
                    <div class="photo-upload-disabled">
                        <div class="disabled-message">
                            <i class="fas fa-info-circle"></i>
                            <span>직원 등록 완료 후 사진을 업로드할 수 있습니다.</span>
                        </div>
                        <input type="hidden" id="photo" name="photo" value="https://i.pravatar.cc/150">
                    </div>
                    {% endif %}
                </div>
            </div>

            {# 명함 영역 (수정 모드에서만 표시) #}
            {% if action == 'update' and employee %}
            <div class="business-card-section" id="businessCardSection">
                <label class="form-label">명함</label>
                <div class="business-card-upload-area">
                    <div class="business-card-grid">
                        {# 앞면 #}
                        <div class="business-card-item" data-side="front">
                            <div class="card-label">앞면</div>
                            <div class="card-preview" id="businessCardFrontPreview">
                                {% if business_card_front %}
                                <img src="{{ business_card_front.file_path }}" alt="명함 앞면">
                                {% else %}
                                <div class="card-placeholder">
                                    <i class="fas fa-id-card"></i>
                                    <span>앞면 미등록</span>
                                </div>
                                {% endif %}
                            </div>
                            <div class="card-actions">
                                <input type="file" id="businessCardFrontFile"
                                       accept="image/jpeg,image/png,image/gif,image/webp"
                                       style="display: none;">
                                <button type="button" class="btn btn-secondary btn-sm"
                                        onclick="document.getElementById('businessCardFrontFile').click()">
                                    <i class="fas fa-upload"></i> 업로드
                                </button>
                                {% if business_card_front %}
                                <button type="button" class="btn btn-outline-danger btn-sm delete-card-btn"
                                        data-side="front">
                                    <i class="fas fa-trash"></i>
                                </button>
                                {% endif %}
                            </div>
                        </div>
                        {# 뒷면 #}
                        <div class="business-card-item" data-side="back">
                            <div class="card-label">뒷면</div>
                            <div class="card-preview" id="businessCardBackPreview">
                                {% if business_card_back %}
                                <img src="{{ business_card_back.file_path }}" alt="명함 뒷면">
                                {% else %}
                                <div class="card-placeholder">
                                    <i class="fas fa-id-card"></i>
                                    <span>뒷면 미등록</span>
                                </div>
                                {% endif %}
                            </div>
                            <div class="card-actions">
                                <input type="file" id="businessCardBackFile"
                                       accept="image/jpeg,image/png,image/gif,image/webp"
                                       style="display: none;">
                                <button type="button" class="btn btn-secondary btn-sm"
                                        onclick="document.getElementById('businessCardBackFile').click()">
                                    <i class="fas fa-upload"></i> 업로드
                                </button>
                                {% if business_card_back %}
                                <button type="button" class="btn btn-outline-danger btn-sm delete-card-btn"
                                        data-side="back">
                                    <i class="fas fa-trash"></i>
                                </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <small class="form-help">JPG, PNG, GIF, WebP (최대 5MB)</small>
                </div>
            </div>
            {% elif action == 'create' %}
            <div class="business-card-section disabled">
                <label class="form-label">명함</label>
                <div class="disabled-message">
                    <i class="fas fa-info-circle"></i>
                    <span>직원 등록 완료 후 명함을 업로드할 수 있습니다.</span>
                </div>
            </div>
            {% endif %}

            <div class="form-grid">
                <div class="form-group">
                    <label for="name" class="form-label">이름 <span class="required">*</span></label>
                    <input type="text" id="name" name="name" class="form-input"
                           value="{{ employee.name if employee else '' }}"
                           placeholder="홍길동" required>
                </div>

                <div class="form-group">
                    <label for="name_en" class="form-label">영문 이름</label>
                    <input type="text" id="name_en" name="name_en" class="form-input"
                           value="{{ employee.name_en if employee and employee.name_en else '' }}"
                           placeholder="Hong Gil-dong">
                </div>

                <div class="form-group">
                    <label for="birth_date" class="form-label">생년월일</label>
                    <input type="date" id="birth_date" name="birth_date" class="form-input"
                           value="{{ employee.birth_date if employee and employee.birth_date else '' }}">
                </div>

                <div class="form-group">
                    <label for="gender" class="form-label">성별</label>
                    <select id="gender" name="gender" class="form-input">
                        <option value="">선택하세요</option>
                        <option value="male" {% if employee and employee.gender == 'male' %}selected{% endif %}>남성</option>
                        <option value="female" {% if employee and employee.gender == 'female' %}selected{% endif %}>여성</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="phone" class="form-label">휴대전화 <span class="required">*</span></label>
                    <input type="tel" id="phone" name="phone" class="form-input"
                           value="{{ employee.phone if employee else '' }}"
                           placeholder="010-1234-5678" required>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">이메일 <span class="required">*</span></label>
                    <input type="email" id="email" name="email" class="form-input"
                           value="{{ employee.email if employee else '' }}"
                           placeholder="example@company.com" required>
                </div>

                <div class="form-group form-group-full">
                    <label for="address" class="form-label">주소</label>
                    <div class="input-with-button">
                        <input type="text" id="address" name="address" class="form-input"
                               value="{{ employee.address if employee and employee.address else '' }}"
                               placeholder="주소 검색 버튼을 클릭하세요" readonly>
                        <button type="button" class="btn btn-secondary" id="searchAddressBtn">
                            <i class="fas fa-search"></i> 주소 검색
                        </button>
                    </div>
                </div>

                <div class="form-group form-group-full">
                    <label for="detailed_address" class="form-label">상세주소</label>
                    <input type="text" id="detailed_address" name="detailed_address" class="form-input"
                           value="{{ employee.detailed_address if employee and employee.detailed_address else '' }}"
                           placeholder="동/호수, 건물명 등">
                </div>

                <div class="form-group">
                    <label for="emergency_contact" class="form-label">비상연락처</label>
                    <input type="tel" id="emergency_contact" name="emergency_contact" class="form-input"
                           value="{{ employee.emergency_contact if employee and employee.emergency_contact else '' }}"
                           placeholder="010-9876-5432">
                </div>

                <div class="form-group">
                    <label for="emergency_relation" class="form-label">비상연락처 관계</label>
                    <input type="text" id="emergency_relation" name="emergency_relation" class="form-input"
                           value="{{ employee.emergency_relation if employee and employee.emergency_relation else '' }}"
                           placeholder="배우자, 부모 등">
                </div>

                <div class="form-group">
                    <label for="rrn" class="form-label">주민등록번호</label>
                    <input type="text" id="rrn" name="rrn" class="form-input"
                           value="{{ employee.rrn if employee and employee.rrn else '' }}"
                           placeholder="850520-1******" maxlength="14">
                    <small class="form-help">마스킹 처리된 형식으로 입력 (예: 850520-1******)</small>
                </div>
            </div>
        </div>
    </div>
</section>
