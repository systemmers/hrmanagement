{#
    직원 상세 - 기본정보 섹션들
    섹션 1-6: 개인정보, 소속정보, 계약정보, 급여정보, 복리후생, 4대보험
#}
{% from 'macros/_info_display.html' import info_item, card_header, section_title %}

{# 섹션 1: 개인 기본정보 #}
<section id="personal-info" class="content-section">
    {{ section_title('개인 기본정보') }}
    <div class="card">
        {{ card_header('개인 기본정보', 'fas fa-user') }}
        <div class="card-body">
            <div class="info-grid">
                {{ info_item('성명 (한글)', employee.name) }}
                {{ info_item('여권명 (영문)', employee.english_name) }}
                {{ info_item('주민등록번호', employee.resident_number) }}
                {{ info_item('생년월일', employee.birth_date) }}
                {{ info_item('성별', get_gender_label(employee.gender)) }}
                <div class="info-item">
                    <div class="info-label">결혼여부</div>
                    <div class="info-value{% if not employee.marital_status %} empty{% endif %}">
                        {{ get_marital_status_label(employee.marital_status) or '정보 없음' }}
                    </div>
                </div>
                {{ info_item('휴대전화', format_phone(employee.phone)) }}
                {{ info_item('개인 이메일', employee.email, highlight=true) }}
                <div class="info-item">
                    <div class="info-label">비상연락처</div>
                    <div class="info-value{% if not employee.emergency_contact %} empty{% endif %}">
                        {{ employee.emergency_contact or '정보 없음' }}{% if employee.emergency_relation %} ({{ employee.emergency_relation }}){% endif %}
                    </div>
                </div>
                {# 신규 필드: 혈액형, 종교, 취미, 특기, 장애정보 #}
                {{ info_item('혈액형', employee.blood_type) }}
                {{ info_item('종교', employee.religion) }}
                {{ info_item('취미', employee.hobby) }}
                {{ info_item('특기', employee.specialty) }}
                {{ info_item('장애정보', employee.disability_info) }}
            </div>
            <div class="mt-5">
                {{ info_item('주민등록상 주소', employee.address) }}
                {{ info_item('상세주소', employee.detailed_address) }}
            </div>
            {# 실제 거주 주소 (항상 표시) #}
            <div class="mt-4">
                <h5 class="info-subsection-title">실제 거주 주소</h5>
                {{ info_item('실제 거주지', employee.actual_address) }}
                {{ info_item('상세주소', employee.actual_detailed_address) }}
            </div>
        </div>
    </div>
</section>

{# 섹션 2: 소속정보 (인사카드 전용) #}
{% if page_mode == 'hr_card' %}
<section id="organization-info" class="content-section">
    {{ section_title('소속정보') }}
    <div class="card">
        {{ card_header('소속정보', 'fas fa-building') }}
        <div class="card-body">
            <div class="info-grid">
                {{ info_item('소속', employee.department, highlight=true) }}
                {{ info_item('부서', employee.team or employee.department, highlight=true) }}
                {{ info_item('직급', employee.position) }}
                {{ info_item('직책', employee.job_title) }}
                {{ info_item('사원번호', employee.employee_number or 'EMP-%03d'|format(employee.id)) }}
                {{ info_item('근무형태', get_employment_type_label(employee.employment_type)) }}
                {{ info_item('근무지', employee.work_location or '본사') }}
                {# 내선번호/회사이메일 - 프로필에서 소속정보로 이동 #}
                {{ info_item('내선번호', employee.internal_phone) }}
                {{ info_item('회사 이메일', employee.company_email) }}
                <div class="info-item">
                    <div class="info-label">재직상태</div>
                    <div class="info-value">
                        <span class="badge {{ get_status_badge_class(employee.status) }}">
                            {{ get_status_text(employee.status) }}
                        </span>
                    </div>
                </div>
                {{ info_item('입사일', employee.hire_date) }}
                {{ info_item('재직기간', calculate_tenure(employee.hire_date), highlight=true) }}
            </div>
        </div>
    </div>
</section>
{% endif %}

{# 섹션 3: 계약정보 (인사카드 전용) #}
{% if page_mode == 'hr_card' %}
<section id="contract-info" class="content-section">
    {{ section_title('계약정보') }}
    <div class="card">
        {{ card_header('계약정보', 'fas fa-file-contract') }}
        <div class="card-body">
            <div class="info-grid">
                {{ info_item('계약형태', contract.contract_type if contract else (get_employment_type_label(employee.employment_type) if employee.employment_type else none)) }}
                {{ info_item('계약기간', contract.contract_period if contract else (employee.contract_period or '무기한')) }}
                {{ info_item('계약시작일', contract.contract_date if contract else employee.hire_date) }}
                {{ info_item('직원유형', contract.employee_type if contract else none) }}
                {{ info_item('근무형태', contract.work_type if contract else none) }}
                {{ info_item('시용기간 종료', employee.probation_end) }}
                {{ info_item('근무시간', '09:00 ~ 18:00') }}
                {{ info_item('휴게시간', '12:00 ~ 13:00') }}
                {% if employee.resignation_date %}
                {{ info_item('퇴사일', employee.resignation_date) }}
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endif %}

{# 섹션 4: 급여정보 (인사카드 전용) #}
{% if page_mode == 'hr_card' %}
<section id="salary-info" class="content-section">
    {{ section_title('급여정보') }}
    <div class="card">
        {{ card_header('급여정보', 'fas fa-won-sign') }}
        <div class="card-body">
            <div class="info-grid">
                {{ info_item('급여형태', salary.salary_type if salary else none) }}
                {{ info_item('기본급', ('{:,}'.format(salary.base_salary) ~ '원') if salary else none) }}
                {{ info_item('직책수당', ('{:,}'.format(salary.position_allowance) ~ '원') if salary else none) }}
                {{ info_item('식대', ('{:,}'.format(salary.meal_allowance) ~ '원') if salary else none) }}
                {{ info_item('교통비', ('{:,}'.format(salary.transportation_allowance) ~ '원') if salary else none) }}
                {{ info_item('총 급여', ('{:,}'.format(salary.total_salary) ~ '원') if salary else none) }}
                {{ info_item('급여지급일', ('매월 ' ~ salary.payment_day ~ '일') if salary else none) }}
                {{ info_item('급여지급방법', salary.payment_method if salary else none) }}
                {{ info_item('급여계좌', salary.bank_account if salary else none) }}
            </div>
        </div>
    </div>
</section>
{% endif %}

{# 섹션 5: 연차 및 복리후생 (인사카드 전용) #}
{% if page_mode == 'hr_card' %}
<section id="benefit-info" class="content-section">
    {{ section_title('연차 및 복리후생') }}
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-umbrella-beach"></i>
                연차 및 복리후생 {% if benefit %}({{ benefit.year }}년){% endif %}
            </h3>
        </div>
        <div class="card-body">
            <div class="info-grid">
                {{ info_item('연차 발생일수', (benefit.annual_leave_granted|string ~ '일') if benefit else none) }}
                {{ info_item('연차 사용일수', (benefit.annual_leave_used|string ~ '일') if benefit else none) }}
                {{ info_item('연차 잔여일수', (benefit.annual_leave_remaining|string ~ '일') if benefit else none, highlight=true) }}
                {{ info_item('퇴직금 유형', benefit.severance_type if benefit else none) }}
                {{ info_item('퇴직금 적립방법', benefit.severance_method if benefit else none) }}
            </div>
        </div>
    </div>
</section>
{% endif %}

{# 섹션 6: 4대보험 (인사카드 전용) #}
{% if page_mode == 'hr_card' %}
<section id="insurance-info" class="content-section">
    {{ section_title('4대보험') }}
    <div class="card">
        {{ card_header('4대보험', 'fas fa-shield-alt') }}
        <div class="card-body">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">4대보험</div>
                    <div class="info-value">
                        {% if insurance and (insurance.national_pension or insurance.health_insurance or insurance.employment_insurance or insurance.industrial_accident) %}
                        <span class="badge badge-success">가입</span>
                        {% else %}
                        <span class="badge badge-secondary">미가입</span>
                        {% endif %}
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">건강보험</div>
                    <div class="info-value">{% if insurance and insurance.health_insurance %}<span class="badge badge-success">가입</span>{% else %}<span class="badge badge-secondary">미가입</span>{% endif %}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">국민연금</div>
                    <div class="info-value">{% if insurance and insurance.national_pension %}<span class="badge badge-success">가입</span>{% else %}<span class="badge badge-secondary">미가입</span>{% endif %}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">고용보험</div>
                    <div class="info-value">{% if insurance and insurance.employment_insurance %}<span class="badge badge-success">가입</span>{% else %}<span class="badge badge-secondary">미가입</span>{% endif %}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">산재보험</div>
                    <div class="info-value">{% if insurance and insurance.industrial_accident %}<span class="badge badge-success">가입</span>{% else %}<span class="badge badge-secondary">미가입</span>{% endif %}</div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

{# 섹션 7: 가족정보 #}
<section id="family-info" class="content-section">
    {{ section_title('가족정보') }}
    <div class="card">
        {{ card_header('가족정보', 'fas fa-users') }}
        <div class="card-body">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>관계</th>
                            <th>성명</th>
                            <th>생년월일</th>
                            <th>직업</th>
                            <th>연락처</th>
                            <th>동거여부</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if family_list %}
                        {% for family in family_list %}
                        <tr>
                            <td>{{ get_relation_label(family.relation) }}</td>
                            <td>{{ family.name }}</td>
                            <td>{{ family.birth_date or '-' }}</td>
                            <td>{{ family.occupation or '-' }}</td>
                            <td>{{ family.phone or '-' }}</td>
                            <td>{% if family.living_together %}<span class="badge badge-success">동거</span>{% else %}<span class="badge badge-secondary">별거</span>{% endif %}</td>
                        </tr>
                        {% endfor %}
                        {% else %}
                        <tr>
                            <td colspan="6" class="table-empty">
                                <i class="fas fa-users"></i>
                                <p>등록된 가족정보가 없습니다</p>
                            </td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>