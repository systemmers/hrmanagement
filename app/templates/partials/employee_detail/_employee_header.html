{#
    직원 상세 - 통합 직원 헤더 카드

    Parameters:
    - employee: 직원 객체 (필수)
    - get_status_text: 상태 텍스트 함수 (선택적)
    - calculate_tenure: 재직기간 계산 함수 (선택적)
    - business_card_front: 명함 앞면 첨부파일 객체 (선택적)
    - business_card_back: 명함 뒷면 첨부파일 객체 (선택적)
    - can_edit_business_card: 명함 편집 권한 여부 (선택적)
    - variant: 'corporate' | 'personal' (기본: 자동 감지)
        - corporate: 회사 소속정보, 명함 표시 (파란 테마)
        - personal: 개인 연락처, 명함 없음 (그린 테마)
#}
{# variant 자동 감지: page_mode가 'hr_card'가 아니면 'personal', 아니면 'corporate' #}
{% set header_variant = variant|default('personal' if page_mode != 'hr_card' else 'corporate') %}
<div class="employee-header{% if header_variant == 'personal' %} employee-header--personal{% endif %}">
    <div class="employee-header-content">
        <div class="employee-header-left">
            <div class="employee-photo">
                <img src="{{ employee.photo }}" alt="{{ employee.name }}" onerror="this.style.display='none'; this.parentElement.innerHTML='<i class=\'fas fa-user\' aria-hidden=\'true\'></i>';">
            </div>
            <div class="employee-info">
                <div class="employee-name">{{ employee.name }}</div>
                <div class="employee-name-en">{{ employee.name|upper }}</div>
                <div class="employee-meta">
                    {% if header_variant == 'corporate' %}
                    {# 법인 계정: 소속 정보 #}
                    <div class="meta-item">
                        <i class="fas fa-building" aria-hidden="true"></i>
                        <span>{{ employee.department }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-id-badge" aria-hidden="true"></i>
                        <span>{{ employee.position }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-calendar-check" aria-hidden="true"></i>
                        <span>{{ get_status_text(employee.status) if get_status_text else employee.status }}</span>
                    </div>
                    {% else %}
                    {# 개인 계정: 연락처 정보 #}
                    <div class="meta-item">
                        <i class="fas fa-envelope" aria-hidden="true"></i>
                        <span>{{ employee.email or '-' }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-phone" aria-hidden="true"></i>
                        <span>{{ employee.phone or '-' }}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                        <span>{{ employee.address or '-' }}</span>
                    </div>
                    {% endif %}
                </div>
                <div class="employee-stats">
                    {% if header_variant == 'corporate' %}
                    {# 법인 계정: 고용 정보 #}
                    <div class="stat-item">
                        <div class="stat-label">입사일</div>
                        <div class="stat-value">{{ employee.hire_date or '-' }}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">재직기간</div>
                        <div class="stat-value">{{ calculate_tenure(employee.hire_date) if calculate_tenure and employee.hire_date else '-' }}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">연차 잔여</div>
                        <div class="stat-value">{{ employee.remaining_leave|default(15) }}일</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">사번</div>
                        <div class="stat-value">EMP-{{ '%03d'|format(employee.id) }}</div>
                    </div>
                    {% else %}
                    {# 개인 계정: 개인 정보 #}
                    <div class="stat-item">
                        <div class="stat-label">생년월일</div>
                        <div class="stat-value">{{ employee.birth_date or '-' }}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">계약 수</div>
                        <div class="stat-value">{{ employee.contract_count|default(0) }}건</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">가입일</div>
                        <div class="stat-value">{{ employee.created_at|default('-') }}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">회원번호</div>
                        <div class="stat-value">USR-{{ '%03d'|format(employee.id) }}</div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        {% if header_variant == 'corporate' %}
        <!-- 명함 카드 영역 (법인 계정 전용) -->
        <div class="business-card-container" data-employee-id="{{ employee.id }}">
            <span class="business-card-title">명함</span>
            <div class="business-card-wrapper">
                <div class="business-card">
                    {% if business_card_front %}
                    <!-- 앞면 -->
                    <div class="card-face card-front">
                        <img src="{{ url_for('static', filename='uploads/business_cards/' ~ business_card_front.file_path.split('/')[-1]) }}" alt="명함 앞면">
                    </div>
                    {% else %}
                    <!-- 앞면 플레이스홀더 -->
                    <div class="card-face card-front">
                        <div class="business-card-placeholder">
                            <i class="fas fa-id-card" aria-hidden="true"></i>
                            <span>앞면</span>
                        </div>
                    </div>
                    {% endif %}

                    {% if business_card_back %}
                    <!-- 뒷면 -->
                    <div class="card-face card-back">
                        <img src="{{ url_for('static', filename='uploads/business_cards/' ~ business_card_back.file_path.split('/')[-1]) }}" alt="명함 뒷면">
                    </div>
                    {% else %}
                    <!-- 뒷면 플레이스홀더 -->
                    <div class="card-face card-back">
                        <div class="business-card-placeholder">
                            <i class="fas fa-id-card" aria-hidden="true"></i>
                            <span>뒷면</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% if business_card_front or business_card_back %}
            <span class="flip-hint"><i class="fas fa-sync-alt" aria-hidden="true"></i> 마우스 오버시 뒤집기</span>
            {% endif %}

            {% if can_edit_business_card %}
            <div class="business-card-actions">
                <button type="button" class="btn-upload-card" data-action="open-business-card-modal">
                    <i class="fas fa-upload" aria-hidden="true"></i> 업로드
                </button>
                {% if business_card_front or business_card_back %}
                <button type="button" class="btn-delete-card" data-action="delete-all-business-cards">
                    <i class="fas fa-trash" aria-hidden="true"></i> 삭제
                </button>
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>
