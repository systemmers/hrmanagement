{#
    폼 컨트롤 매크로
    재사용 가능한 폼 입력 요소 매크로 정의
#}

{# 텍스트/이메일/전화 등 기본 입력 필드 #}
{% macro form_input(name, label, type='text', value='', required=false, placeholder='', help_text='', css_class='', maxlength='') %}
<div class="form-group {{ css_class }}">
    <label for="{{ name }}" class="form-label">
        {{ label }}{% if required %} <span class="required" aria-hidden="true">*</span>{% endif %}
    </label>
    <input type="{{ type }}"
           id="{{ name }}"
           name="{{ name }}"
           class="form-input"
           value="{{ value }}"
           placeholder="{{ placeholder }}"
           {% if required %}required aria-required="true"{% endif %}
           {% if help_text %}aria-describedby="{{ name }}_help"{% endif %}
           {% if maxlength %}maxlength="{{ maxlength }}"{% endif %}>
    {% if help_text %}
    <small id="{{ name }}_help" class="form-help">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{# 셀렉트 박스 #}
{% macro form_select(name, label, options, selected='', required=false, css_class='', help_text='') %}
<div class="form-group {{ css_class }}">
    <label for="{{ name }}" class="form-label">
        {{ label }}{% if required %} <span class="required" aria-hidden="true">*</span>{% endif %}
    </label>
    <select id="{{ name }}"
            name="{{ name }}"
            class="form-input"
            {% if required %}required aria-required="true"{% endif %}
            {% if help_text %}aria-describedby="{{ name }}_help"{% endif %}>
        <option value="">선택하세요</option>
        {% for opt in options %}
            {% if opt is mapping %}
            <option value="{{ opt.value }}" {% if opt.value == selected %}selected{% endif %}>{{ opt.label }}</option>
            {% else %}
            <option value="{{ opt }}" {% if opt == selected %}selected{% endif %}>{{ opt }}</option>
            {% endif %}
        {% endfor %}
    </select>
    {% if help_text %}
    <small id="{{ name }}_help" class="form-help">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{# 카드 헤더 (추가 버튼 포함 옵션) #}
{% macro form_card_header(title, icon, add_button_id='') %}
<div class="card-header">
    <h2 class="card-title">
        <i class="{{ icon }}" aria-hidden="true"></i>
        {{ title }}
    </h2>
    {% if add_button_id %}
    <button type="button"
            class="btn btn-sm btn-secondary"
            id="{{ add_button_id }}"
            aria-label="{{ title }} 추가">
        <i class="fas fa-plus" aria-hidden="true"></i> 추가
    </button>
    {% endif %}
</div>
{% endmacro %}

{# 동적 리스트 아이템 삭제 버튼 #}
{% macro remove_button(item_name='항목') %}
<button type="button" class="btn-remove" title="삭제" aria-label="{{ item_name }} 삭제">
    <i class="fas fa-times" aria-hidden="true"></i>
</button>
{% endmacro %}

{# 텍스트영역 입력 필드 #}
{% macro form_textarea(name, label, value='', required=false, placeholder='', help_text='', css_class='', rows=3) %}
<div class="form-group {{ css_class }}">
    <label for="{{ name }}" class="form-label">
        {{ label }}{% if required %} <span class="required" aria-hidden="true">*</span>{% endif %}
    </label>
    <textarea id="{{ name }}"
              name="{{ name }}"
              class="form-input"
              rows="{{ rows }}"
              placeholder="{{ placeholder }}"
              {% if required %}required aria-required="true"{% endif %}
              {% if help_text %}aria-describedby="{{ name }}_help"{% endif %}>{{ value }}</textarea>
    {% if help_text %}
    <small id="{{ name }}_help" class="form-help">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}

{# 체크박스 #}
{% macro form_checkbox(name, label, checked=false, help_text='', css_class='') %}
<div class="form-group form-group--checkbox {{ css_class }}">
    <label class="form-checkbox">
        <input type="checkbox"
               id="{{ name }}"
               name="{{ name }}"
               {% if checked %}checked{% endif %}
               {% if help_text %}aria-describedby="{{ name }}_help"{% endif %}>
        <span class="form-checkbox__label">{{ label }}</span>
    </label>
    {% if help_text %}
    <small id="{{ name }}_help" class="form-help">{{ help_text }}</small>
    {% endif %}
</div>
{% endmacro %}
