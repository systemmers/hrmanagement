{% extends "base.html" %}

{% block title %}직원 수정 - 인사카드 관리 시스템{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-title-row">
        <h1 class="page-title">직원 수정</h1>
        <div class="page-actions">
            <a href="{{ url_for('employee.detail', id=employee.id) }}" class="btn btn-secondary">
                <i class="fas fa-times"></i>
                <span>취소</span>
            </a>
        </div>
    </div>
    <p class="page-description">{{ employee.name }}님의 정보를 수정합니다</p>
</div>

<style>
    .form-container {
        background-color: var(--color-pure-white);
        border-radius: var(--radius-lg);
        padding: var(--space-8);
        box-shadow: var(--shadow-sm);
    }

    .form-section {
        margin-bottom: var(--space-8);
    }

    .form-section-title {
        font-size: var(--text-xl);
        font-weight: 600;
        color: var(--color-gray-900);
        margin-bottom: var(--space-4);
        padding-bottom: var(--space-3);
        border-bottom: 2px solid var(--color-gray-200);
    }

    .form-row {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-4);
        margin-bottom: var(--space-4);
    }

    .form-group {
        margin-bottom: var(--space-4);
    }

    .form-group.full-width {
        grid-column: 1 / -1;
    }

    .form-label {
        display: block;
        font-size: var(--text-sm);
        font-weight: 500;
        color: var(--color-gray-700);
        margin-bottom: var(--space-2);
    }

    .form-label.required::after {
        content: " *";
        color: #ef4444;
    }

    .form-input,
    .form-select,
    .form-textarea {
        width: 100%;
        padding: var(--space-2-5) var(--space-3);
        border: 1px solid var(--color-gray-300);
        border-radius: var(--radius-md);
        font-size: var(--text-sm);
        transition: all var(--transition-fast);
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
        outline: none;
        border-color: var(--color-gray-900);
        box-shadow: var(--shadow-sm);
    }

    .form-textarea {
        resize: vertical;
        min-height: 80px;
    }

    .photo-upload {
        display: flex;
        align-items: center;
        gap: var(--space-4);
    }

    .photo-preview {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid var(--color-gray-200);
    }

    .photo-upload-label {
        padding: var(--space-2-5) var(--space-4);
        background-color: var(--color-gray-100);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all var(--transition-fast);
    }

    .photo-upload-label:hover {
        background-color: var(--color-gray-200);
    }

    .form-actions {
        display: flex;
        gap: var(--space-3);
        justify-content: flex-end;
        margin-top: var(--space-8);
        padding-top: var(--space-6);
        border-top: 1px solid var(--color-gray-200);
    }
</style>

<div class="form-container">
    <form method="POST" action="{{ url_for('employee.edit', id=employee.id) }}" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <!-- 기본 정보 -->
        <div class="form-section">
            <h2 class="form-section-title">기본 정보</h2>

            <div class="form-group full-width">
                <label class="form-label">사진</label>
                <div class="photo-upload">
                    {% if employee.photo %}
                    <img id="photoPreview"
                         src="{{ url_for('static', filename='uploads/' + employee.photo) }}"
                         alt="{{ employee.name }}"
                         class="photo-preview"
                         onerror="this.src='https://i.pravatar.cc/150?img={{ employee.id % 70 }}'">
                    {% else %}
                    <img id="photoPreview"
                         src="https://i.pravatar.cc/150?img={{ employee.id % 70 }}"
                         alt="{{ employee.name }}"
                         class="photo-preview">
                    {% endif %}
                    <label class="photo-upload-label">
                        {{ form.photo(style="display: none;") }}
                        <i class="fas fa-camera"></i>
                        사진 변경
                    </label>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="name" class="form-label required">성명</label>
                    {{ form.name(class="form-input", id="name") }}
                    {% if form.name.errors %}
                        {% for error in form.name.errors %}
                            <div style="color: #ef4444; font-size: var(--text-xs); margin-top: var(--space-1);">{{ error }}</div>
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="phone" class="form-label">전화번호</label>
                    {{ form.phone(class="form-input", id="phone", type="tel") }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="email" class="form-label">이메일</label>
                    {{ form.email(class="form-input", id="email") }}
                </div>
            </div>

            <div class="form-group">
                <label for="address" class="form-label">주소</label>
                {{ form.address(class="form-textarea", id="address") }}
            </div>
        </div>

        <!-- 소속 정보 -->
        <div class="form-section">
            <h2 class="form-section-title">소속 정보</h2>

            <div class="form-row">
                <div class="form-group">
                    <label for="department_id" class="form-label">부서</label>
                    {{ form.department_id(class="form-select", id="department_id") }}
                </div>

                <div class="form-group">
                    <label for="position_id" class="form-label">직급</label>
                    {{ form.position_id(class="form-select", id="position_id") }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="hire_date" class="form-label">입사일</label>
                    {{ form.hire_date(class="form-input", id="hire_date") }}
                </div>

                <div class="form-group">
                    <label for="employment_type" class="form-label">고용형태</label>
                    {{ form.employment_type(class="form-select", id="employment_type") }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="workplace" class="form-label">근무지</label>
                    {{ form.workplace(class="form-input", id="workplace") }}
                </div>

                <div class="form-group">
                    <label for="status" class="form-label">상태</label>
                    {{ form.status(class="form-select", id="status") }}
                </div>
            </div>
        </div>

        <!-- 액션 버튼 -->
        <div class="form-actions">
            <a href="{{ url_for('employee.detail', id=employee.id) }}" class="btn btn-secondary">
                <i class="fas fa-times"></i>
                <span>취소</span>
            </a>
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
</div>
{% endblock %}
